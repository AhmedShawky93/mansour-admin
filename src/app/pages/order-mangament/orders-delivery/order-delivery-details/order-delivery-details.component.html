<ngx-loading-bar [color]="'#eb1c24'"></ngx-loading-bar>
<div class="top-table-bar" style="margin-bottom: 30px;">
  <div class="row">
    <div class="col-md-3">
      <a class="back-btn" [routerLink]="['/pages/orders-delivery']">
        <i class="fa fa-angle-left" aria-hidden="true"></i> Back</a>
    </div>

    <div class="col-md-9" *ngIf="order">

    </div>
  </div>
</div>


<div class="block-title">
  <h4>General Info </h4>
</div>

<div class="block" *ngIf="order">
  <div class="row">
    <div class="col-md-5">
      <div class="block-item">
        <p> Company Name</p>
        <span>Name</span>
      </div>

      <div class="block-item">
        <p>Phone number </p>
        <span>{{ order.created_at | date: "d-M-yyyy  h:mm a" }}</span>
      </div>

      <div class="block-item">
        <p>Date order </p>
        <span>{{ order.scheduled_at | date: "d-M-yyyy  h:mm a" }}</span>
      </div>


    </div>
    <div class="col-md-2">
    </div>
    <div class="col-md-5">
      <div class="block-item">
        <p>count Order </p>
        <span>{{ order.deliverer?.name }}</span>
      </div>
      <div class="block-item">
        <p> State Order </p>
        <span>{{ order.deliverer?.name }}</span>
      </div>
    </div>


  </div>
</div>

<div class="block-title">
  <h4> details order #</h4>
</div>

<div class="block" *ngIf="order">
  <h6 class="copy-skus" (click)="copyInputMessage()">Print</h6>
  <div *ngFor="let item of order.items; index as i">
    <div class="block-ratings">
      <p>{{ i + 1 }}</p>
      <img [src]="item?.product.image" alt="" class="owl-img" width="80" />
      <div class="content">
        <h4>{{ item.product.name }}</h4>
        <p>{{ item.product.sku }}</p>
      </div>
    </div>

    <div class="qty-item">
      <p>QTY: {{ item.amount }}</p>
      <span *ngIf="item?.discount_price === null">{{ item.price }} LE</span>
      <span *ngIf="item?.discount_price !== null">{{ item.discount_price }} LE</span>
    </div>
  </div>
</div>

<div class="block-title" *ngIf="order && order.schedule">
  <h4>Recurring</h4>
</div>

<div class="block" *ngIf="order && order.schedule">
  <div class="row">
    <div class="col-md-5">
      <div class="block-item">
        <p>Repeat Every</p>
        <span *ngIf="order.schedule.interval == 1">Day</span>
        <span *ngIf="order.schedule.interval == 2">Week</span>
        <span *ngIf="order.schedule.interval == 3">Month</span>
      </div>

      <div class="block-item">
        <p>Time</p>
        <span>{{ order.schedule.time }}</span>
      </div>
    </div>

    <div class="col-md-2"></div>

    <div class="col-md-5">
      <div class="block-item">
        <p>Previous Repeats</p>
        <span>{{ order.reorder_count }}</span>
      </div>

      <div class="block-item">
        <p>Next Time</p>
        <span>{{ order.schedule.next_order }}</span>
      </div>
    </div>
  </div>
</div>

<!-- <div class="block-title">
  <h4>customer Details</h4>
</div> -->

<!-- <div class="block" *ngIf="order">
  <div class="row">
    <div class="col-md-5">
      <div class="block-item">
        <p>id</p>
        <span>{{ order.user.id }}</span>
      </div>
      <div class="block-item">
        <p>name</p>
        <span>{{ order.user.name }}</span>
      </div>
    </div>
    <div class="col-md-1"></div>
    <div class="col-md-6">
      <div class="block-item">
        <p>number</p>
        <span>{{ order.user.phone }}</span>
      </div>
      <div class="block-item">
        <p>email</p>
        <span>{{ order.user.email }}</span>
      </div>
    </div>
    <div class="col-sm-12">
      <div class="block-item">
        <p>address</p>
        <span>{{ order.address.formatted_address }}
          <a *ngIf="order.address.lat" href="https://www.google.com/maps/search/?api=1&query={{
              order.address.lat
            }},{{ order.address.lng }}" target="_blank"><i class="fa fa-external-link"></i></a></span>
      </div>
    </div>
  </div>
</div> -->
<!-- <div class="block-title">
  <h4>Billing Details</h4>
</div> -->

<!-- <div class="block" *ngIf="order">
  <div class="row">
    <div class="col-md-4">
      <div class="block-item">
        <p>Applied Offer</p>
        <span *ngIf="order.promo">{{ order.promo.name }} -{{ order.promo.amount }}
          <span *ngIf="order.promo.type == 2">%</span><span *ngIf="order.promo.type == 1">LE</span></span>
      </div>

      <div class="block-item">
        <p>Remaining</p>
        <span>{{ order.remaining }}</span>
      </div>
      <div class="block-item">
        <p>admin discount</p>
        <span>{{ order?.admin_discount ? order.admin_discount : "-" }}</span>
      </div>

      <div class="block-item">
        <p>Delivery Fees</p>
        <span>{{ order.delivery_fees }}</span>
      </div>
    </div>

    <div class="col-md-4"></div>

    <div class="col-md-4">
      <div class="block-item">
        <p>Payment Method</p>
        <span>{{ order.payment_method == 1 ? "Cash" : "Visa" }}</span>
      </div>

      <div class="block-item">
        <p>Item Total</p>
        <span>{{ order.invoice.total_amount  | number : '1.2-2'}}</span>
      </div>

      <div class="block-item">
        <p>Discount</p>
        <span
          *ngIf="order.invoice.promo_id">{{ (order.invoice.total_amount - order.invoice.discount  )| number : '1.2-2'}}</span>
        <span *ngIf="!order.invoice.promo_id">-</span>
      </div>

      <div class="block-item">
        <p>Grand Total</p>
        <span>{{ (order.amount + order.delivery_fees) | number : '1.2-2' }}</span>
      </div>
    </div>
  </div>
</div> -->

<!-- <div class="block-title" *ngIf="(order?.items)[0]?.returned_quantity">
  <h4>Return product</h4>
</div> -->
<!--
<div class="block" *ngIf="(order?.items)[0]?.returned_quantity">
  <div *ngFor="let item of order.items; index as i">
    <div *ngIf="item.returned_quantity">
      <div class="block-ratings">
        <p>{{ i + 1 }}</p>
        <img [src]="item?.product.image" alt="" class="owl-img" width="80" />
        <div class="content">
          <h4>{{ item.product.name }}</h4>
          <p>{{ item.product.sku }}</p>
        </div>
      </div>

      <div class="qty-item">
        <p>QTY: {{ item.returned_quantity }}</p>
        <span *ngIf="item?.product.discount_price === null">{{ item.product.price }} LE</span>
        <span *ngIf="item?.product.discount_price !== null">{{ item.product.discount_price }} LE</span>
      </div>
    </div>
  </div>
</div> -->

<!-- <div class="block-title">
  <h4>order milestones</h4>
</div> -->

<div class="modal fade" id="confirmOrderStatus" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" style="text-align: center;">
          Are you sure you want to change Status this order ?
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <label class="checkup">
          notify user
          <input type="checkbox" checked="checked" [(ngModel)]="notifyUser" />
          <span class="checkmark"></span>
        </label>

        <div class="form-group" *ngIf="orderStatusId == '6'">
          <label for="">Status notes </label>
          <textarea style="height: 130px;" class="owl-input" placeholder="Type.." #status_notes="ngModel"
            [(ngModel)]="status_notesText">
          </textarea>
          <div class="alert-danger" *ngIf="error_status_notes">
            <span>
              Cancel notes is required
            </span>
          </div>
        </div>
      </div>
      <div class="modal-footer" style="justify-content: center;">
        <button type="button" class="btn-owls btn-rounded btn-green btn-blue2"
          (click)="confirmChangeStatus(notifyUser)">
          Yes
        </button>
        <button type="button" data-dismiss="modal" class="btn-owls btn-rounded btn-green btn-red2">
          no
        </button>
      </div>
    </div>
  </div>
</div>
